---
import SiteLayout from "../layouts/SiteLayout.astro";

// Use Astro.glob() to fetch all notes, and then sort them by date.
const notes = (await Astro.glob("./notes/*.{md,mdx}")).sort(
  (a, b) =>
    new Date(b.frontmatter.pubDate).valueOf() -
    new Date(a.frontmatter.pubDate).valueOf()
);
const nonDraftNotes = notes.filter((note) => {
  return Object.keys(note.frontmatter).length > 0 && !note.frontmatter.draft;
});
---

<SiteLayout>
  <h5>Notes - Snippets, rough and loosely coupled</h5>
  <br />
  <section>
    <ul>
      {
        nonDraftNotes.map((note) => {
          const { url, frontmatter } = note;
          return (
            <li>
              <h4>
                <a href={url}>{frontmatter.title}</a>
              </h4>
              <p>{frontmatter.description}</p>
              {frontmatter.pubDate && (
                <time datetime={frontmatter.pubDate}>
                  {new Date(frontmatter.pubDate).toLocaleDateString("en-us", {
                    year: "numeric",
                    month: "short",
                    day: "numeric",
                  })}
                </time>
              )}
            </li>
          );
        })
      }
    </ul>
  </section>
</SiteLayout>

<style>
  li {
    min-height: 7ex;
    margin: 16px 0;
    padding: 5px 0;
    list-style-type: none;
    border-width: 0.01ch;
    border-radius: 0.5ch;
    display: flex;
    flex-direction: column;
  }
  a {
    width: fit-content;
  }
</style>
